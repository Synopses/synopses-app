<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1">
  <title>Patient Synopses</title>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">

  <meta name="apple-mobile-web-app-status-bar-style" content="#e32d43">
  <meta name="msapplication-TileColor" content="#e32d43">
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="theme-color" content="#e32d43">

  <base href="..">

  <link rel="icon" sizes="192x192" href="images/synopses-icon.png">

  <link rel="manifest" href="manifest.json">

  <link rel="stylesheet" href="app.css">

  <!-- Polyfill webcomponents in browsers that don't support it. -->
  <script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>

  <!--
  <link rel="import" href="vulcanized.html">
  -->
  <link rel="import" href="elements.html">
</head>
<body fullbleed>

  <!-- <iron-iconset name="my-icons" src="images/pill-24.png" width="24" size="24"
      icons="pill">
  </iron-iconset> -->

<template id="t" is="dom-bind">

<div id="loginscreen"
     class$="[[_computeLoginScreenClass(isAuthenticated, 'layout vertical center-center fit')]]"
     hidden="{{DEBUG}}">
     <login-polyform on-login="mockLogin" username="demo" password="demo" credentials="{{_user}}">
      <img avatar src="images/synopses-icon.png"/>
    </login-polyform>
</div>

<patient-form ident="addpatient" title="Edit my profile"
  on-patient-saved="loadPatients"></patient-form>

<selfcheck-form ident="selfcheck" title="Patient self check"
  patientid="{{selectedPatient.id}}"
  on-record-saved="patientSaved"></selfcheck-form>

<div class="layout vertical shadowbox">
  <div>
    <paper-toolbar id="mainheader" class$="[[headerClass]]">
    <paper-icon-button icon="arrow-back" class="selected-item" on-tap="deselectAll"></paper-icon-button>

    <div class="flex"></div>

    <span class="top indent title patientapp">My Synopses</span>

    <paper-item id="patientdetails" class="middle" hidden="{{!selectedPatient}}">
      <span class="layout horizontal center justified">
        <profile-img id="profileimage" item-icon
                     src="{{item.photo}}"></profile-img>
        <span class="label patient_name">
          <b>{{selectedPatient.name}}</b>
        </span>
        <span class="label" hidden="{{!selectedPatient.record.date_birth}}">
          Born:
          <time>{{selectedPatient.record.date_birth}}</time>
        </span>
        <span class="label" hidden="{{!selectedPatient.gender}}">
          Gender:
          <span>{{selectedPatient.gender}}</span>
        </span>
        <span class="label" hidden="{{!selectedPatient.record.blood_group}}">
          B.G.:
          <span>{{selectedPatient.record.blood_group}}</span>
        </span>
        <span class="label">
          Last visit:
          <time>{{selectedPatient.updated}}</time>
        </span>
        <paper-fab id="editpatient" mini icon="create" class="icon-create"
           on-tap="openDialog" data-dialog="addpatient" style="margin-left:2em"
           hidden="{{!selectedPatient}}"></paper-fab>
      </span>
    </paper-item>
  </div>
  <div content on-thread-archive="onThreadArchive">
      <template is="dom-if" if="{{_computeShowSpinner(threads, signedIn)}}">
        <div class="layout vertical center-center" style="height:100%">
          <paper-spinner active></paper-spinner>
        </div>
      </template>

      <!-- TODO: don't pass all messages, users, labels into mail-thread -->
      <iron-selector id="threadlist" multi activate-event=""
                     selected-attribute="selected"
                     selected-items="{{selectedThreads}}"
                     on-iron-select="_onThreadSelectChange"
                     on-iron-deselect="_onThreadSelectChange">
        <template is="dom-repeat" items="[[threads]]">
          <record-thread messages="[[item.messages]]"
                       labels="[[labelMap]]" users="[[users]]"
                       narrow="[[narrow]]"
                       on-label-select="_onLabelTap"
                       on-thread-select="_onThreadTap"></record-thread>
        </template>
      </iron-selector>
  </div>

</div><!-- /.layout vertical -->


<paper-toast id="toast" class="layout horizontal justified"
             duration="10000" text="{{toastMessage}}" visible="{{toastOpened}}"
             on-paper-overlay-open="onToastOpenClose"
             on-transitionend="onToastOpenClose">
  <div on-tap="undoAll" class="undo">Undo</div>
</paper-toast>

<paper-fab id="fab-selfcheck" icon="accessibility" class="action-icon"
   on-tap="openDialog" data-dialog="selfcheck"></paper-fab>

<!-- Cache data requests. -->
<!--<iron-localstorage name="polymer-mail-user" value="{{user}}"></iron-localstorage>-->
<!--<iron-localstorage name="polymer-mail-labels" value="{{labels}}"></iron-localstorage>-->
<!--<iron-localstorage name="polymer-mail-threads" value="{{threads}}"></iron-localstorage>-->
<!--<iron-localstorage name="polymer-mail-users" value="{{users}}"></iron-localstorage>-->

</template>

<!--<script src="scripts/polymer_metrics.js"></script>-->
<script src="app.js"></script>
<script>
  <!-- analytics -->
</script>
</body>
</html>
