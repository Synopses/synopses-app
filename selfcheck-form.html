<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="bower_components/iron-pages/iron-pages.html">
<link rel="import" href="bower_components/iron-autogrow-textarea/iron-autogrow-textarea.html">
<link rel="import" href="bower_components/pikaday-decorator/pikaday-decorator.html">

<dom-module id="selfcheck-form">
<style>
:host {
  --paper-toolbar-background: #00bcd4;
}

:host paper-tabs, :host paper-toolbar {
  background-color: #00bcd4;
  color: #fff;
  box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.2);
}

:host paper-toolbar paper-tabs {
  box-shadow: none;
}

:host paper-tabs[noink][no-bar] paper-tab.iron-selected {
  color: #ffff8d;
}

:host form paper-icon-button {
  color: #333333;
}

:host label { margin-right:1em; }

#dropzone {
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
  border-radius: 5px;
  padding: 20px 10px;
  text-align: center;
  font: 20pt bold 'Helvetica';
  color: #bbb;
  background: white;
}

#files {
  display: block;
  margin: 0 auto;;
}

#files::-webkit-file-upload-button {
  visibility: hidden;
}

#files::before {
  content: 'or click to select files';
  background: white;
  padding: 5px;
  outline: none;
  white-space: nowrap;
  -webkit-user-select: none;
  cursor: pointer;
  font-size: 16pt;
  margin: 0 auto;
}

#files:hover::before {
  border-color: black;
}

#files:active::before {
  background: -webkit-linear-gradient(top, #e3e3e3, #f9f9f9);
}

paper-radio-button.blue {
  --paper-radio-button-checked-color: var(--paper-light-blue-500);
  --paper-radio-button-checked-ink-color: var(--paper-light-blue-500);
  --paper-radio-button-unchecked-color: var(--paper-light-blue-900);
  --paper-radio-button-unchecked-ink-color: var(--paper-light-blue-900);
}

paper-radio-button.red {
  --paper-radio-button-checked-color: var(--paper-red-500);
  --paper-radio-button-checked-ink-color: var(--paper-red-500);
  --paper-radio-button-unchecked-color: var(--paper-red-900);
  --paper-radio-button-unchecked-ink-color: var(--paper-red-900);
}

paper-radio-button.green {
  --paper-radio-button-checked-color: var(--paper-green-500);
  --paper-radio-button-checked-ink-color: var(--paper-green-500);
  --paper-radio-button-unchecked-color: var(--paper-green-900);
  --paper-radio-button-unchecked-ink-color: var(--paper-green-900);
}

paper-radio-button.orange {
  --paper-radio-button-checked-color: var(--paper-orange-500);
  --paper-radio-button-checked-ink-color: var(--paper-orange-500);
  --paper-radio-button-unchecked-color: var(--paper-orange-900);
  --paper-radio-button-unchecked-ink-color: var(--paper-orange-900);
}

:host input, :host select, :host button {
  font-size: 16px;
}

pikaday-decorator {
  margin-bottom: 2em;
}
</style>
<template>
  <paper-dialog id="{{ ident }}" modal>
    <h2>{{ title }}</h2>

    <div class="record-SELFCHECK">
      <form is="iron-form" method="post" data-type="SELFCHECK" data-typeid="1">
        <div class="vertical layout">
          <h3>How are you?</h3>
          <div class="horizontal-section">
            <paper-radio-group name="subject">
              <paper-radio-button class="green" name="better" value="Patient feels improved">Better</paper-radio-button>
              <paper-radio-button class="blue" name="same" value="Patient feels the same">The same</paper-radio-button>
              <paper-radio-button class="orange" name="worse" value="Patient feels worse">Worsening</paper-radio-button>
            </paper-radio-group>
          </div>
          <h3>Please elaborate:</h3>
          <iron-autogrow-textarea id="ta1" name="note" label="Note" required maxRows="16" rows="8">
            <textarea name="note" id="ta1" rows="6"></textarea>
          </iron-autogrow-textarea>
        </div>
      </form>
    </div>

    <div class="buttons">
      <paper-button dialog-dismiss>Cancel</paper-button>
      <paper-button raised on-tap="saveDialog">Save</paper-button>
    </div>
  </paper-dialog>
</template>
<script>
  Polymer({
    is: 'selfcheck-form',

    properties: {
      title: {
        value: "New record",
        reflectToAttribute: true
      },
      recordType: {
        value: 1
      },
      patientid: {
        value: null,
        reflectToAttribute: true
      },
      //////
      p_date_birth: { value: "01.01.1900" },
      p_weight: { value: "" },
      p_height: { value: "" }
    },

    saveDialog: function(e) {
      var the_form = this.$.recordform.selectedItem.firstElementChild;
      if (this.patientid === null) {
        alert("Invalid patient ID"); return;
      }
      the_form.action =
        '/api/' + this.patientid +
        '/record/' + the_form.dataset.typeid +
        '/save';
      the_form.submit();
      the_form.reset();
      var all_fields = the_form.querySelectorAll(
        'input[type="text"],gold-email-input,paper-input'
      );
      for (var i = 0; i < all_fields.length; i++) {
        if (typeof all_fields[i].value !== 'undefined') {
          all_fields[i].value = "";
        }
      }
      this.fire('record-saved');
      document.getElementById(this.ident).close();
    }

  });
</script>
</dom-module>
